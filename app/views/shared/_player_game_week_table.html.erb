<% if player.player_game_weeks.joins(game_week: :season).where("season_id = ?", Season.current.first.id).count > 0 %>
	<div class="mdl-card__title">
		<h3 class="mdl-card__title-text">Stats</h3>
	</div>
	<div class="mdl-card__actions">
		<div class="mdl-card__title">
			<h4 class="mdl-card__title-text">Summary</h4>
		</div>
		<table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
			<tr>
				<th>
					<span>Mp</span>
				</th>
				<th>
					<span>Att</span>
				</th>
				<th>
					<span>Att / 90</span>
				</th>
				<th>
					<span>Def</span>
				</th>
				<th>
					<span>Def / 90</span>
				</th>
			</tr>
			<tr>
				<td class="normal-text">
					<%= total_minutes_played = player.total_minutes_played(Season.current.first) %> / <%= player.eligible_game_weeks(Season.current.first) * 90 %>
				</td>
				<td class="normal-text">
					<%= total_attacking_contribution = player.total_attacking_contribution(Season.current.first) %>
				</td>
				<td class="normal-text">
					<%= total_minutes_played > 0 ? (total_attacking_contribution / (total_minutes_played.to_f / 90)).round(3) : (0.to_f).round(3) %>
				</td>
				<td class="normal-text">
					<%= total_defensive_contribution = player.total_defensive_contribution(Season.current.first) %>
				</td>
				<td class="normal-text">
					<%= total_minutes_played > 0 ? (total_defensive_contribution / (total_minutes_played.to_f / 90)).round(3) : (0.to_f).round(3) %>
				</td>
			</tr>
		</table>
		<div class="mdl-card__title">
			<h4 class="mdl-card__title-text">Game weeks</h4>
		</div>
		<table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
			<tr>
				<th class="mdl-data-table__cell--non-numeric">
					<span>Season</span>
				</th>
				<th>
					<span>GW</span>
				</th>
				<th>
					<span>Mp</span>
				</th>
				<th>
					<span>Gs</span>
				</th>
				<th>
					<span>A</span>
				</th>
				<th>
					<span>Gc</span>
				</th>
			</tr>
			<% player.player_game_weeks.joins(game_week: :season).where("season_id = ?", Season.current.first.id).order("game_weeks.starts_at DESC").each do |pgw| %>
				<tr>
					<td class="mdl-data-table__cell--non-numeric normal-text">
						<%= pgw.game_week.season.description %>
					</td>
					<td class="normal-text">
						<%= pgw.game_week.game_week_number %>
					</td>
					<td class="normal-text">
						<%= pgw.minutes_played.to_i %>
					</td>
					<td class="normal-text">
						<%= pgw.goals.to_i %>
					</td>
					<td class="normal-text">
						<%= pgw.assists.to_i %>
					</td>
					<td class="normal-text">
						<%= pgw.goals_conceded.to_i %>
					</td>
				</tr>
			<% end %>
		</table>
	</div>
<% else %>
	<div class="mdl-card__title">
		<h3 class="mdl-card__title-text">Stats</h3>
	</div>
	<div class="mdl-card__actions">
		<div class="mdl-card__title">
			<h4 class="mdl-card__title-text">Summary</h4>
		</div>
		<table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
			<tr>
				<th>
					<span>Mp</span>
				</th>
				<th>
					<span>Att</span>
				</th>
				<th>
					<span>Att / 90</span>
				</th>
				<th>
					<span>Def</span>
				</th>
				<th>
					<span>Def / 90</span>
				</th>
			</tr>
			<tr>
				<td class="mdl-data-table__cell--non-numeric normal-text" colspan="5">
					No game weeks played.
				</td>
			</tr>
		</table>
		<div class="mdl-card__title">
			<h4 class="mdl-card__title-text">Game weeks</h4>
		</div>
		<table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
			<tr>
				<th class="mdl-data-table__cell--non-numeric">
					<span>Season</span>
				</th>
				<th>
					<span>GW</span>
				</th>
				<th>
					<span>Mp</span>
				</th>
				<th>
					<span>Gs</span>
				</th>
				<th>
					<span>A</span>
				</th>
				<th>
					<span>Gc</span>
				</th>
			</tr>
			<tr>
				<td class="mdl-data-table__cell--non-numeric normal-text">
					No game weeks played.
				</td>
			</tr>
		</table>
	</div>
<% end %>
