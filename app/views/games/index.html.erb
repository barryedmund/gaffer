<% league = League.find(params[:league_id]) %>
<div class="row">
	<div class="col-sm-12">
		<div class="demo-card-wide mdl-card mdl-shadow--2dp">
			<div class="mdl-card__title">
        <h2 class="mdl-card__title-text">
        	<%= link_to league.name, league_path(league), class: "content-link" %>
        	<span>&nbsp;games</span>
        </h2>
      </div>
      <% this_game_week_games = @games.where(home_team_score: nil, away_team_score: nil, game_week: league.current_game_week) %>
    	<% if this_game_week_games.count > 0 %>
    		<div class="mdl-card__title">
    			<h3 class="mdl-card__title-text">This week's games</h3>
    		</div>
    		<div class="mdl-card__actions">
    			<table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
    				<%= render partial: 'game_index_header_row' %>
						<% this_game_week_games.each do |game| %>
							<%= render partial: 'game_index_row', locals: { game: game } %>
						<% end %>
					</table>
    		</div>
    	<% end %>
      <div class="mdl-card__actions">
      	<% if @games.count > 0 %>
      		<div class="mdl-card__title">
    				<h3 class="mdl-card__title-text">All games</h3>
    			</div>
      		<table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
      			<%= render partial: 'game_index_header_row' %>
            <% games_to_display = @games.joins(:game_week).order('game_weeks.game_week_number').paginate(page: params[:page], per_page: (league.teams.count * 4)) %>
						<% games_to_display.each do |game| %>
							<%= render partial: 'game_index_row', locals: { game: game } %>
						<% end %>
					</table>
      	<% else %>
      		<span class="normal-text">Games for this season are yet to be scheduled.</span>
      	<% end %>
        <%= will_paginate games_to_display %>
      </div>
    </div>
  </div>
</div>
